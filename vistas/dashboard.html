<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Dashboard - HIDROGEST</title>
    <link
      rel="icon"
      type="image/png"
      sizes="16x16"
      href="/favicon/favicon-16x16.png"
    />
    <meta name="msapplication-TileColor" content="#ffffff" />
    <meta name="theme-color" content="#ffffff" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="dashboard.css" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
  </head>
  <body>
    <!-- Header Superior -->
    <header class="header">
      <div class="header-left">
        <div class="logo">
          <img src="LOGO.png" alt="HIDROGEST Logo" />
          <span class="logo-text">HIDROGEST</span>
        </div>
      </div>

      <div class="header-center">
        <div class="search-bar">
          <input type="text" placeholder="Buscar en el sistema..." />
          <button class="search-btn">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
              <path
                d="M21 21L16.514 16.506L21 21ZM19 10.5C19 15.194 15.194 19 10.5 19C5.806 19 2 15.194 2 10.5C2 5.806 5.806 2 10.5 2C15.194 2 19 5.806 19 10.5Z"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
              />
            </svg>
          </button>
        </div>
      </div>

      <div class="header-right">
        <div class="notifications">
          <button class="notification-btn" id="notificationBtn">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
              <path
                d="M18 8A6 6 0 0 0 6 8C6 15 3 17 3 17H21C21 17 18 15 18 8Z"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
              />
              <path
                d="M13.73 21A2 2 0 0 1 10.27 21"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
              />
            </svg>
            <span class="notification-badge" id="notificationBadge">3</span>
          </button>
        </div>

        <div class="user-menu">
          <button class="user-btn" id="userBtn">
            <div class="user-avatar">JD</div>
            <div class="user-info">
              <span class="user-name">Juan Doe</span>
              <span class="user-type">Propietario</span>
            </div>
            <svg
              class="chevron"
              width="16"
              height="16"
              viewBox="0 0 24 24"
              fill="none"
            >
              <path
                d="M6 9L12 15L18 9"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
              />
            </svg>

            <!-- User Dropdown -->
            <div class="user-dropdown" id="userDropdown">
              <div class="dropdown-item" data-action="settings">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                  <path
                    d="M12 20H21"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  />
                  <path
                    d="M16.5 3.5C17.163 2.837 17.948 2.5 18.75 2.5C19.552 2.5 20.337 2.837 21 3.5C21.663 4.163 22 4.948 22 5.75C22 6.552 21.663 7.337 21 8L12 17L7 12L16.5 3.5Z"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  />
                </svg>
                <span>Configuración</span>
              </div>
              <div class="dropdown-item" data-action="help">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                  <path
                    d="M9 21H5A2 2 0 0 1 3 19V5A2 2 0 0 1 5 3H11L13 5H19A2 2 0 0 1 21 7V9"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  />
                  <path
                    d="M16 2V6H20"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  />
                  <path
                    d="M9 15L15 9"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  />
                  <path
                    d="M9 9H9.01"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  />
                  <path
                    d="M15 15H15.01"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  />
                </svg>
                <span>Ayuda</span>
              </div>
              <div class="dropdown-divider"></div>
              <div class="dropdown-item logout" data-action="logout">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                  <path
                    d="M9 21H5A2 2 0 0 1 3 19V5A2 2 0 0 1 5 3H11L13 5H19A2 2 0 0 1 21 7V19A2 2 0 0 1 19 21H9Z"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  />
                  <path
                    d="M16 2V6H20"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  />
                  <path
                    d="M9 15L15 9"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  />
                  <path
                    d="M9 9H9.01"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  />
                  <path
                    d="M15 15H15.01"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  />
                </svg>
                <span>Cerrar Sesión</span>
              </div>
            </div>
          </button>
        </div>
      </div>
    </header>

    <!-- Sidebar -->
    <aside class="sidebar" id="sidebar">
      <nav class="sidebar-nav">
        <div class="nav-section">
          <h3 class="nav-title">Principal</h3>
          <ul class="nav-list">
            <li class="nav-item active">
              <a href="#" class="nav-link">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                  <path
                    d="M3 9L12 2L21 9V20C21 20.5304 20.7893 21.0391 20.4142 21.4142C20.0391 21.7893 19.5304 22 19 22H5C4.46957 22 3.96086 21.7893 3.58579 21.4142C3.21071 21.0391 3 20.5304 3 20V9Z"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  />
                  <polyline
                    points="9,22 9,12 15,12 15,22"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  />
                </svg>
                <span>Dashboard</span>
              </a>
            </li>
            <li class="nav-item">
              <a href="./usuarios/mi-perfil/mi_perfil.html" class="nav-link">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                  <path
                    d="M20 21V19C20 17.9391 19.5786 16.9217 18.8284 16.1716C18.0783 15.4214 17.0609 15 16 15H8C6.93913 15 5.92172 15.4214 5.17157 16.1716C4.42143 16.9217 4 17.9391 4 19V21"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  />
                  <circle
                    cx="12"
                    cy="7"
                    r="4"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  />
                </svg>
                <span>Mi Perfil</span>
              </a>
            </li>
            <li class="nav-item">
              <a href="#" class="nav-link">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                  <rect
                    x="3"
                    y="4"
                    width="18"
                    height="18"
                    rx="2"
                    ry="2"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  />
                  <line
                    x1="16"
                    y1="2"
                    x2="16"
                    y2="6"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  />
                  <line
                    x1="8"
                    y1="2"
                    x2="8"
                    y2="6"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  />
                  <line
                    x1="3"
                    y1="10"
                    x2="21"
                    y2="10"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  />
                </svg>
                <span>Calendario</span>
              </a>
            </li>
          </ul>
        </div>

        <div class="nav-section">
          <ul class="nav-list">
            <li class="nav-item">
              <a href="./usuarios/incidencias/incidencias.html" class="nav-link">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                  <path
                    d="M10.29 3.86L1.82 18A2 2 0 0 0 3.82 20H20.18A2 2 0 0 0 22.18 18L13.71 3.86A2 2 0 0 0 10.29 3.86Z"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  />
                  <line
                    x1="12"
                    y1="9"
                    x2="12"
                    y2="13"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  />
                  <line
                    x1="12"
                    y1="17"
                    x2="12.01"
                    y2="17"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  />
                </svg>
                <span>Reportar Incidencia</span>
              </a>
            </li>
            <li class="nav-item">
              <a href="./usuarios/mis-reportes/mis-reportes.html" class="nav-link">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                  <path
                    d="M14 2H6A2 2 0 0 0 4 4V20A2 2 0 0 0 6 22H18A2 2 0 0 0 20 20V8L14 2Z"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  />
                  <polyline
                    points="14,2 14,8 20,8"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  />
                  <line
                    x1="16"
                    y1="13"
                    x2="8"
                    y2="13"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  />
                  <line
                    x1="16"
                    y1="17"
                    x2="8"
                    y2="17"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  />
                  <polyline
                    points="10,9 9,9 8,9"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  />
                </svg>
                <span>Mis Reportes</span>
              </a>
            </li>
          </ul>
        </div>

        <div class="nav-section owner-only">
          <h3 class="nav-title">Propietarios</h3>
          <ul class="nav-list">
            <li class="nav-item">
              <a href="#" class="nav-link">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                  <path
                    d="M14 2H6A2 2 0 0 0 4 4V20A2 2 0 0 0 6 22H18A2 2 0 0 0 20 20V8L14 2Z"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  />
                  <polyline
                    points="14,2 14,8 20,8"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  />
                  <line
                    x1="16"
                    y1="13"
                    x2="8"
                    y2="13"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  />
                  <line
                    x1="16"
                    y1="17"
                    x2="8"
                    y2="17"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  />
                  <polyline
                    points="10,9 9,9 8,9"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  />
                </svg>
                <span>Mis Facturas</span>
              </a>
            </li>
            <li class="nav-item">
              <a href="#" class="nav-link">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                  <path
                    d="M12 1V23"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  />
                  <path
                    d="M17 5H9.5A3.5 3.5 0 0 0 6 8.5V11A3.5 3.5 0 0 0 9.5 14.5H17"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  />
                </svg>
                <span>Realizar Pago</span>
              </a>
            </li>
            <li class="nav-item">
              <a href="#" class="nav-link">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                  <path
                    d="M3 9L12 2L21 9V20C21 20.5304 20.7893 21.0391 20.4142 21.4142C20.0391 21.7893 19.5304 22 19 22H5C4.46957 22 3.96086 21.7893 3.58579 21.4142C3.21071 21.0391 3 20.5304 3 20V9Z"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  />
                  <polyline
                    points="9,22 9,12 15,12 15,22"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  />
                </svg>
                <span>Mis Propiedades</span>
              </a>
            </li>
          </ul>
        </div>
      </nav>
    </aside>

    <!-- Contenido Principal -->
    <main class="main-content">
      
      <!--Mapa -->
      <div
        id="map"
        style="height: 300px; border-radius: 12px; margin-bottom: 20px"
      ></div>
      <!-- Panel de Estado del Servicio -->
      <section class="service-status-panel">
        <div class="status-header">
          <h2>Estado del Servicio</h2>
          <span class="last-update">Última actualización: hace 5 min</span>
        </div>

        <div class="status-grid">
          <div class="status-card normal">
            <div class="status-icon">💧</div>
            <div class="status-info">
              <h3>Estado Actual</h3>
              <p class="status-text">Normal</p>
              <span class="status-description"
                >Servicio funcionando correctamente</span
              >
            </div>
          </div>

          <div class="status-card warning">
            <div class="status-icon">⚠️</div>
            <div class="status-info">
              <h3>Próximo Corte</h3>
              <p class="status-text">Mañana 8:00 AM</p>
              <span class="status-description">Mantenimiento programado</span>
            </div>
          </div>

          <div class="status-card info">
            <div class="status-icon">📅</div>
            <div class="status-info">
              <h3>Horario Hoy</h3>
              <p class="status-text">6:00 AM - 10:00 PM</p>
              <span class="status-description">Suministro normal</span>
            </div>
          </div>
        </div>
      </section>

      <!-- Widgets Informativos -->
      <div class="widgets-grid">
        <!-- Widget de Notificaciones -->
        <div class="widget notifications-widget">
          <div class="widget-header">
            <h3>Notificaciones Recientes</h3>
            <button class="widget-action" onclick="showNotificationsModal()">
              Ver todas
            </button>
          </div>
          <div class="notifications-list">
            <div class="notification-item unread">
              <div class="notification-icon warning">⚠️</div>
              <div class="notification-content">
                <p class="notification-text">
                  Corte programado mañana de 8:00 AM a 12:00 PM
                </p>
                <span class="notification-time">Hace 2 horas</span>
              </div>
            </div>
            <div class="notification-item unread">
              <div class="notification-icon info">📋</div>
              <div class="notification-content">
                <p class="notification-text">
                  Tu factura del mes está lista para revisar
                </p>
                <span class="notification-time">Hace 1 día</span>
              </div>
            </div>
            <div class="notification-item">
              <div class="notification-icon success">✅</div>
              <div class="notification-content">
                <p class="notification-text">
                  Incidencia reportada ha sido resuelta
                </p>
                <span class="notification-time">Hace 2 días</span>
              </div>
            </div>
          </div>
        </div>

        <!-- Widget de Acciones Rápidas -->
        <div class="widget actions-widget">
          <div class="widget-header">
            <h3>Acciones Rápidas</h3>
          </div>
          <div class="actions-grid">
            <button class="action-btn primary">
              <span class="action-icon">🚨</span>
              <span class="action-text">Reportar Incidencia</span>
            </button>
            <button class="action-btn secondary">
              <span class="action-icon">📅</span>
              <span class="action-text">Ver Calendario</span>
            </button>
            <button class="action-btn secondary">
              <span class="action-icon">📧</span>
              <span class="action-text">Notificaciones</span>
            </button>
            <button class="action-btn success owner-only">
              <span class="action-icon">💳</span>
              <span class="action-text">Pagar Factura</span>
            </button>
          </div>
        </div>
      </div>

      <!-- Panel de Información del Usuario -->
      <div class="user-info-grid">
        <!-- Panel de Facturación (Solo Propietarios) -->
        <div class="widget billing-widget owner-only">
          <div class="widget-header">
            <h3>Facturación</h3>
            <button class="widget-action" onclick="showPaymentModal()">
              Ver todas
            </button>
          </div>
          <div class="billing-summary">
            <div class="billing-stat">
              <span class="stat-label">Facturas Pendientes</span>
              <span class="stat-value">$45.50</span>
            </div>
            <div class="billing-stat">
              <span class="stat-label">Próximo Vencimiento</span>
              <span class="stat-value">15 Dic</span>
            </div>
            <div class="billing-stat">
              <span class="stat-label">Último Pago</span>
              <span class="stat-value">$32.00</span>
            </div>
          </div>
          <div class="billing-actions">
            <button class="billing-btn primary" onclick="showBillsModal()">
              Ver Facturas
            </button>
            <button class="billing-btn secondary" onclick="showPaymentModal()">
              Realizar Pago
            </button>
          </div>
        </div>

        <!-- Panel de Propiedades (Solo Propietarios) -->
        <div class="widget properties-widget owner-only">
          <div class="widget-header">
            <h3>Mis Propiedades</h3>
            <button class="widget-action" onclick="showSettingsModal()">
              Gestionar
            </button>
          </div>
          <div class="properties-summary">
            <div class="property-item">
              <div class="property-info">
                <h4>Casa Principal</h4>
                <span class="property-location">Sector Norte</span>
              </div>
              <span class="property-status active">Activa</span>
            </div>
            <div class="property-item">
              <div class="property-info">
                <h4>Apartamento</h4>
                <span class="property-location">Centro</span>
              </div>
              <span class="property-status active">Activa</span>
            </div>
          </div>
        </div>
      </div>
    </main>

    <!-- User Dropdown moved inside the button for proper positioning -->

    <!-- Modal de Notificaciones -->
    <div class="modal" id="notificationsModal">
      <div class="modal-overlay" id="notificationsModalOverlay"></div>
      <div class="modal-content">
        <div class="modal-header">
          <h3>Notificaciones</h3>
          <button class="modal-close" id="notificationsModalClose">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
              <path
                d="M18 6L6 18M6 6L18 18"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
              />
            </svg>
          </button>
        </div>
        <div class="modal-body">
          <div class="notifications-filters">
            <button class="filter-btn active" data-filter="all">Todas</button>
            <button class="filter-btn" data-filter="cortes">Cortes</button>
            <button class="filter-btn" data-filter="mantenimiento">
              Mantenimiento
            </button>
            <button class="filter-btn" data-filter="facturacion">
              Facturación
            </button>
          </div>
          <div class="notifications-list-full">
            <div class="notification-item unread" data-type="cortes">
              <div class="notification-icon warning">⚠️</div>
              <div class="notification-content">
                <p class="notification-text">
                  Corte programado mañana de 8:00 AM a 12:00 PM en el Sector
                  Norte
                </p>
                <span class="notification-time">Hace 2 horas</span>
              </div>
              <button class="notification-mark-read">✓</button>
            </div>
            <div class="notification-item unread" data-type="facturacion">
              <div class="notification-icon info">📋</div>
              <div class="notification-content">
                <p class="notification-text">
                  Tu factura del mes está lista para revisar. Monto: $45.50
                </p>
                <span class="notification-time">Hace 1 día</span>
              </div>
              <button class="notification-mark-read">✓</button>
            </div>
            <div class="notification-item" data-type="mantenimiento">
              <div class="notification-icon success">✅</div>
              <div class="notification-content">
                <p class="notification-text">
                  Incidencia reportada ha sido resuelta. El servicio está
                  funcionando normalmente
                </p>
                <span class="notification-time">Hace 2 días</span>
              </div>
            </div>
            <div class="notification-item" data-type="cortes">
              <div class="notification-icon info">📅</div>
              <div class="notification-content">
                <p class="notification-text">
                  Recordatorio: Corte de mantenimiento programado para el
                  próximo viernes
                </p>
                <span class="notification-time">Hace 3 días</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Modal de Reportar Incidencia -->
    <div class="modal" id="incidentModal">
      <div class="modal-overlay" id="incidentModalOverlay"></div>
      <div class="modal-content">
        <div class="modal-header">
          <h3>Reportar Incidencia</h3>
          <button class="modal-close" id="incidentModalClose">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
              <path
                d="M18 6L6 18M6 6L18 18"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
              />
            </svg>
          </button>
        </div>
        <div class="modal-body">
          <form id="incidentForm" class="modal-form">
            <div class="form-group">
              <label for="incidentType"
                >Tipo de Incidencia <span class="required">*</span></label
              >
              <select id="incidentType" name="incidentType" required>
                <option value="">Seleccionar tipo</option>
                <option value="corte">Corte de agua</option>
                <option value="baja_presion">Baja presión</option>
                <option value="agua_sucia">Agua sucia</option>
                <option value="fuga">Fuga de agua</option>
                <option value="otro">Otro</option>
              </select>
            </div>
            <div class="form-group">
              <label for="incidentLocation"
                >Ubicación <span class="required">*</span></label
              >
              <input
                type="text"
                id="incidentLocation"
                name="incidentLocation"
                placeholder="Dirección o sector"
                required
              />
            </div>
            <div class="form-group">
              <label for="incidentDescription"
                >Descripción <span class="required">*</span></label
              >
              <textarea
                id="incidentDescription"
                name="incidentDescription"
                rows="4"
                placeholder="Describe detalladamente la incidencia..."
                required
              ></textarea>
            </div>
            <div class="form-group">
              <label for="incidentPriority">Prioridad</label>
              <select id="incidentPriority" name="incidentPriority">
                <option value="baja">Baja</option>
                <option value="media" selected>Media</option>
                <option value="alta">Alta</option>
                <option value="urgente">Urgente</option>
              </select>
            </div>
            <div class="form-actions">
              <button type="button" class="btn-secondary" id="incidentCancel">
                Cancelar
              </button>
              <button type="submit" class="btn-primary">
                Reportar Incidencia
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>

    <!-- Modal de Calendario -->
    <div class="modal" id="calendarModal">
      <div class="modal-overlay" id="calendarModalOverlay"></div>
      <div class="modal-content large">
        <div class="modal-header">
          <h3>Calendario de Suministro</h3>
          <button class="modal-close" id="calendarModalClose">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
              <path
                d="M18 6L6 18M6 6L18 18"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
              />
            </svg>
          </button>
        </div>
        <div class="modal-body">
          <div class="calendar-header">
            <button class="calendar-nav" id="prevMonth">‹</button>
            <h4 id="currentMonth">Diciembre 2024</h4>
            <button class="calendar-nav" id="nextMonth">›</button>
          </div>
          <div class="calendar-grid" id="calendarGrid">
            <!-- Calendar will be generated by JavaScript -->
          </div>
          <div class="calendar-legend">
            <div class="legend-item">
              <span class="legend-color normal"></span>
              <span>Suministro Normal</span>
            </div>
            <div class="legend-item">
              <span class="legend-color maintenance"></span>
              <span>Mantenimiento</span>
            </div>
            <div class="legend-item">
              <span class="legend-color cut"></span>
              <span>Corte Programado</span>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Modal de Facturas -->
    <div class="modal" id="billsModal">
      <div class="modal-overlay" id="billsModalOverlay"></div>
      <div class="modal-content large">
        <div class="modal-header">
          <h3>Mis Facturas</h3>
          <button class="modal-close" id="billsModalClose">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
              <path
                d="M18 6L6 18M6 6L18 18"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
              />
            </svg>
          </button>
        </div>
        <div class="modal-body">
          <div class="bills-filters">
            <button class="filter-btn active" data-filter="all">Todas</button>
            <button class="filter-btn" data-filter="pending">Pendientes</button>
            <button class="filter-btn" data-filter="paid">Pagadas</button>
            <button class="filter-btn" data-filter="overdue">Vencidas</button>
          </div>

          <div class="bills-summary">
            <div class="summary-card">
              <div class="summary-icon pending">📋</div>
              <div class="summary-info">
                <span class="summary-label">Pendientes</span>
                <span class="summary-value">$45.50</span>
              </div>
            </div>
            <div class="summary-card">
              <div class="summary-icon overdue">⚠️</div>
              <div class="summary-info">
                <span class="summary-label">Vencidas</span>
                <span class="summary-value">$0.00</span>
              </div>
            </div>
            <div class="summary-card">
              <div class="summary-icon paid">✅</div>
              <div class="summary-info">
                <span class="summary-label">Pagadas</span>
                <span class="summary-value">$156.80</span>
              </div>
            </div>
          </div>

          <div class="bills-list">
            <div class="bill-item pending" data-status="pending">
              <div class="bill-header">
                <div class="bill-number">#FAC-2024-001</div>
                <div class="bill-status pending">Pendiente</div>
              </div>
              <div class="bill-details">
                <div class="bill-info">
                  <h4>Factura de Diciembre 2024</h4>
                  <p class="bill-period">Período: 01/12/2024 - 31/12/2024</p>
                  <p class="bill-property">
                    Propiedad: Casa Principal - Sector Norte
                  </p>
                </div>
                <div class="bill-amount">
                  <span class="amount">$45.50</span>
                  <span class="due-date">Vence: 15 Dic 2024</span>
                </div>
              </div>
              <div class="bill-actions">
                <button
                  class="btn-secondary"
                  onclick="downloadBill('FAC-2024-001')"
                >
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                    <path
                      d="M21 15V19A2 2 0 0 1 19 21H5A2 2 0 0 1 3 19V15"
                      stroke="currentColor"
                      stroke-width="2"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                    />
                    <polyline
                      points="7,10 12,15 17,10"
                      stroke="currentColor"
                      stroke-width="2"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                    />
                    <line
                      x1="12"
                      y1="15"
                      x2="12"
                      y2="3"
                      stroke="currentColor"
                      stroke-width="2"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                    />
                  </svg>
                  Descargar
                </button>
                <button
                  class="btn-primary"
                  onclick="payBill('FAC-2024-001', 45.50)"
                >
                  Pagar Ahora
                </button>
              </div>
            </div>

            <div class="bill-item paid" data-status="paid">
              <div class="bill-header">
                <div class="bill-number">#FAC-2024-002</div>
                <div class="bill-status paid">Pagada</div>
              </div>
              <div class="bill-details">
                <div class="bill-info">
                  <h4>Factura de Noviembre 2024</h4>
                  <p class="bill-period">Período: 01/11/2024 - 30/11/2024</p>
                  <p class="bill-property">
                    Propiedad: Casa Principal - Sector Norte
                  </p>
                </div>
                <div class="bill-amount">
                  <span class="amount">$38.20</span>
                  <span class="paid-date">Pagada: 10 Nov 2024</span>
                </div>
              </div>
              <div class="bill-actions">
                <button
                  class="btn-secondary"
                  onclick="downloadBill('FAC-2024-002')"
                >
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                    <path
                      d="M21 15V19A2 2 0 0 1 19 21H5A2 2 0 0 1 3 19V15"
                      stroke="currentColor"
                      stroke-width="2"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                    />
                    <polyline
                      points="7,10 12,15 17,10"
                      stroke="currentColor"
                      stroke-width="2"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                    />
                    <line
                      x1="12"
                      y1="15"
                      x2="12"
                      y2="3"
                      stroke="currentColor"
                      stroke-width="2"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                    />
                  </svg>
                  Descargar
                </button>
                <button class="btn-success" disabled>Pagada</button>
              </div>
            </div>

            <div class="bill-item paid" data-status="paid">
              <div class="bill-header">
                <div class="bill-number">#FAC-2024-003</div>
                <div class="bill-status paid">Pagada</div>
              </div>
              <div class="bill-details">
                <div class="bill-info">
                  <h4>Factura de Octubre 2024</h4>
                  <p class="bill-period">Período: 01/10/2024 - 31/10/2024</p>
                  <p class="bill-property">Propiedad: Apartamento - Centro</p>
                </div>
                <div class="bill-amount">
                  <span class="amount">$42.60</span>
                  <span class="paid-date">Pagada: 12 Oct 2024</span>
                </div>
              </div>
              <div class="bill-actions">
                <button
                  class="btn-secondary"
                  onclick="downloadBill('FAC-2024-003')"
                >
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                    <path
                      d="M21 15V19A2 2 0 0 1 19 21H5A2 2 0 0 1 3 19V15"
                      stroke="currentColor"
                      stroke-width="2"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                    />
                    <polyline
                      points="7,10 12,15 17,10"
                      stroke="currentColor"
                      stroke-width="2"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                    />
                    <line
                      x1="12"
                      y1="15"
                      x2="12"
                      y2="3"
                      stroke="currentColor"
                      stroke-width="2"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                    />
                  </svg>
                  Descargar
                </button>
                <button class="btn-success" disabled>Pagada</button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Modal de Pago -->
    <div class="modal" id="paymentModal">
      <div class="modal-overlay" id="paymentModalOverlay"></div>
      <div class="modal-content">
        <div class="modal-header">
          <h3>Realizar Pago</h3>
          <button class="modal-close" id="paymentModalClose">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
              <path
                d="M18 6L6 18M6 6L18 18"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
              />
            </svg>
          </button>
        </div>
        <div class="modal-body">
          <div class="payment-summary">
            <h4>Resumen de Facturación</h4>
            <div class="payment-details">
              <div class="payment-item">
                <span>Factura:</span>
                <span class="bill-number" id="paymentBillNumber"
                  >#FAC-2024-001</span
                >
              </div>
              <div class="payment-item">
                <span>Monto:</span>
                <span class="amount" id="paymentAmount">$45.50</span>
              </div>
              <div class="payment-item">
                <span>Vencimiento:</span>
                <span class="due-date" id="paymentDueDate">15 Dic 2024</span>
              </div>
              <div class="payment-item total">
                <span>Total a Pagar:</span>
                <span class="amount" id="paymentTotal">$45.50</span>
              </div>
            </div>
          </div>

          <form id="paymentForm" class="modal-form">
            <div class="form-group">
              <label for="paymentMethod"
                >Método de Pago <span class="required">*</span></label
              >
              <select
                id="paymentMethod"
                name="paymentMethod"
                required
                onchange="togglePaymentFields()"
              >
                <option value="">Seleccionar método</option>
                <option value="debit">Tarjeta de Débito</option>
                <option value="credit">Tarjeta de Crédito</option>
                <option value="transfer">Transferencia Bancaria</option>
                <option value="cash">Efectivo</option>
              </select>
            </div>

            <div
              class="payment-method-fields"
              id="cardFields"
              style="display: none"
            >
              <div class="form-group">
                <label for="cardNumber"
                  >Número de Tarjeta <span class="required">*</span></label
                >
                <input
                  type="text"
                  id="cardNumber"
                  name="cardNumber"
                  placeholder="1234 5678 9012 3456"
                  maxlength="19"
                />
              </div>
              <div class="form-row">
                <div class="form-group">
                  <label for="expiryDate"
                    >Fecha de Vencimiento <span class="required">*</span></label
                  >
                  <input
                    type="text"
                    id="expiryDate"
                    name="expiryDate"
                    placeholder="MM/AA"
                    maxlength="5"
                  />
                </div>
                <div class="form-group">
                  <label for="cardCVV"
                    >CVV <span class="required">*</span></label
                  >
                  <input
                    type="text"
                    id="cardCVV"
                    name="cardCVV"
                    placeholder="123"
                    maxlength="3"
                  />
                </div>
              </div>
              <div class="form-group">
                <label for="cardholderName"
                  >Nombre del Titular <span class="required">*</span></label
                >
                <input
                  type="text"
                  id="cardholderName"
                  name="cardholderName"
                  placeholder="Juan Doe"
                />
              </div>
            </div>

            <div
              class="payment-method-fields"
              id="transferFields"
              style="display: none"
            >
              <div class="form-group">
                <label for="bankName"
                  >Banco <span class="required">*</span></label
                >
                <select id="bankName" name="bankName">
                  <option value="">Seleccionar banco</option>
                  <option value="banesco">Banesco</option>
                  <option value="banco_venezuela">Banco de Venezuela</option>
                  <option value="bbva">BBVA Provincial</option>
                  <option value="mercantil">Banco Mercantil</option>
                  <option value="bancaribe">Bancaribe</option>
                </select>
              </div>
              <div class="form-group">
                <label for="accountNumber"
                  >Número de Cuenta <span class="required">*</span></label
                >
                <input
                  type="text"
                  id="accountNumber"
                  name="accountNumber"
                  placeholder="0000-0000-0000-0000"
                />
              </div>
              <div class="form-group">
                <label for="referenceNumber"
                  >Número de Referencia <span class="required">*</span></label
                >
                <input
                  type="text"
                  id="referenceNumber"
                  name="referenceNumber"
                  placeholder="Ref-123456789"
                />
              </div>
            </div>

            <div class="form-actions">
              <button type="button" class="btn-secondary" id="paymentCancel">
                Cancelar
              </button>
              <button type="submit" class="btn-primary">Confirmar Pago</button>
            </div>
          </form>
        </div>
      </div>
    </div>

    <!-- Modal de Configuración -->
    <div class="modal" id="settingsModal">
      <div class="modal-overlay" id="settingsModalOverlay"></div>
      <div class="modal-content">
        <div class="modal-header">
          <h3>Configuración</h3>
          <button class="modal-close" id="settingsModalClose">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
              <path
                d="M18 6L6 18M6 6L18 18"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
              />
            </svg>
          </button>
        </div>
        <div class="modal-body">
          <div class="settings-section">
            <h4>Notificaciones</h4>
            <div class="setting-item">
              <label class="switch">
                <input type="checkbox" id="emailNotifications" checked />
                <span class="slider"></span>
              </label>
              <span>Notificaciones por Email</span>
            </div>
            <div class="setting-item">
              <label class="switch">
                <input type="checkbox" id="smsNotifications" />
                <span class="slider"></span>
              </label>
              <span>Notificaciones por SMS</span>
            </div>
          </div>
          <div class="settings-section">
            <h4>Privacidad</h4>
            <div class="setting-item">
              <label class="switch">
                <input type="checkbox" id="dataSharing" checked />
                <span class="slider"></span>
              </label>
              <span>Compartir datos de uso</span>
            </div>
          </div>
          <div class="form-actions">
            <button type="button" class="btn-secondary" id="settingsCancel">
              Cancelar
            </button>
            <button type="button" class="btn-primary" id="settingsSave">
              Guardar Cambios
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Modal de Ayuda -->
    <div class="modal" id="helpModal">
      <div class="modal-overlay" id="helpModalOverlay"></div>
      <div class="modal-content">
        <div class="modal-header">
          <h3>Centro de Ayuda</h3>
          <button class="modal-close" id="helpModalClose">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
              <path
                d="M18 6L6 18M6 6L18 18"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
              />
            </svg>
          </button>
        </div>
        <div class="modal-body">
          <div class="help-sections">
            <div class="help-section">
              <h4>📋 Cómo Reportar una Incidencia</h4>
              <p>1. Haz clic en "Reportar Incidencia" en el dashboard</p>
              <p>2. Selecciona el tipo de problema</p>
              <p>3. Describe detalladamente la situación</p>
              <p>4. Envía el reporte</p>
            </div>
            <div class="help-section">
              <h4>💳 Cómo Realizar un Pago</h4>
              <p>1. Ve a "Realizar Pago" en el menú</p>
              <p>2. Selecciona el método de pago</p>
              <p>3. Ingresa los datos de tu tarjeta</p>
              <p>4. Confirma la transacción</p>
            </div>
            <div class="help-section">
              <h4>📅 Cómo Ver el Calendario</h4>
              <p>1. Haz clic en "Ver Calendario"</p>
              <p>2. Navega entre los meses</p>
              <p>3. Revisa los eventos programados</p>
            </div>
          </div>
          <div class="help-contact">
            <h4>¿Necesitas más ayuda?</h4>
            <p>📧 Email: soporte@hidrogest.com</p>
            <p>📞 Teléfono: +58 212-555-0123</p>
            <p>🕒 Horario: Lunes a Viernes 8:00 AM - 6:00 PM</p>
          </div>
        </div>
      </div>
    </div>

    <script src="dashboard.js"></script>
    <script>
      // Coordenadas de San Juan de los Morros, Guárico, Venezuela
      const lat = 9.91152;
      const lon = -67.35377;

      // Inicializar mapa
      const map = L.map("map").setView([lat, lon], 14);

      // Capa base OpenStreetMap
      L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
        attribution: "&copy; OpenStreetMap contributors",
      }).addTo(map);

      // Marcador en San Juan de los Morros
      L.marker([lat, lon])
        .addTo(map)
        .bindPopup("📍 San Juan de los Morros, Guárico - Venezuela")
        .openPopup();
    </script>
  </body>
</html>
